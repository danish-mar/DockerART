{%extends 'layout.html'%}
{%block title%}Home ‚óè DockerART{%endblock%}
{%block content%}

    <!-- Tiles for showing docker related Information -->
    <div class="container tileContainer">
        <div class="text">
            <h1><i class="fab fa-docker"></i>
            Docker Status : </h1>
        </div>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-4">
                    <div class="tile">
                        <div class="icon">
                            <i class="fas fa-cube"></i>
                        </div>
                        <div class="text">
                            Containers Running : <span class="running_containers">0</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="tile">
                        <div class="icon">
                            <i class="fas fa-compact-disc"></i>
                        </div>
                        <div class="text">
                            Images : <span class="current_images">0</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="tile">
                        <div class="icon">
                            <i class="fa fa-cubes" aria-hidden="true"></i>
                        </div>
                        <div class="text">
                            Total Containers : <span class="total_containers">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <!-- Tiles for showing server related Information -->
    <div class="container tileContainer">
        <div class="text">
            <h1><i class="fa-solid fa-server"></i>
            Server Status : </h1>
        </div>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-4">
                    <div class="tile">
                        <div class="icon">
                            <i class="fa fa-microchip" aria-hidden="true"></i>
                            CPU : 
                        </div>
                        <div class="text">
                            <meter min="5" max="100" value="70" class="cpu_meter meterS" ></meter>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="tile">
                        <div class="icon">
                            <i class="fas fa-memory"></i>
                            RAM :
                        </div>
                        <div class="text">
                            <meter min="5" max="100" value="70" class="ram_meter meterS"></meter>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


<script>
    function updateDockerInfo() {
        fetch('/api/docker-info')
            .then(response => response.json())
            .then(data => {
                // Update Docker-related information on the webpage
                document.querySelector('.running_containers').innerText = data.running_containers;
                document.querySelector('.current_images').innerText = data.current_images;
                document.querySelector('.total_containers').innerText = data.total_containers;
            });
    }

    function updateServerInfo() {
        fetch('/api/server-info')
            .then(response => response.json())
            .then(data => {
                // Update Server-related information on the webpage
                document.querySelector('.cpu_meter').value = data.cpu_usage;
                document.querySelector('.ram_meter').value = data.ram_usage;
            });
    }

    // Refresh data every second
    setInterval(function () {
        updateDockerInfo();
        updateServerInfo();
    }, 500);
</script>

{%endblock%}
